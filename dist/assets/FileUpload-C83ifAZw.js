var C=(u,b,o)=>new Promise((N,c)=>{var v=l=>{try{s(o.next(l))}catch(r){c(r)}},h=l=>{try{s(o.throw(l))}catch(r){c(r)}},s=l=>l.done?N(l.value):Promise.resolve(l.value).then(v,h);s((o=o.apply(u,b)).next())});import{j as e,s as k}from"./index-wYB_OSb7.js";import{r as x}from"./react-vendor-BcqdGgAs.js";import{a2 as M,X as S,a3 as I,z as g,a6 as D,F as E}from"./ui-vendor-BPow5NNe.js";const L=({bucket:u,folder:b,onUploadComplete:o,acceptedFileTypes:N="image/*,application/pdf",maxSizeMB:c=10,label:v="Upload File",description:h="PDF or Image files"})=>{const[s,l]=x.useState(null),[r,w]=x.useState(!1),[f,d]=x.useState(0),[y,p]=x.useState(null),m=x.useRef(null),P=t=>{var i;const a=(i=t.target.files)==null?void 0:i[0];if(!a)return;const n=c*1024*1024;if(a.size>n){g.error(`File size must be less than ${c}MB`);return}if(l(a),a.type.startsWith("image/")){const j=new FileReader;j.onload=R=>{var U;p((U=R.target)==null?void 0:U.result)},j.readAsDataURL(a)}else p(null)},$=()=>C(void 0,null,function*(){if(!s){g.error("Please select a file");return}try{w(!0),d(0);const t=s.name.split(".").pop(),a=`${Date.now()}-${Math.random().toString(36).substring(7)}.${t}`,n=`${b}/${a}`;d(30);const{error:i}=yield k.storage.from(u).upload(n,s,{cacheControl:"3600",upsert:!1});if(i)throw i;d(70);const{data:j}=k.storage.from(u).getPublicUrl(n);d(100),g.success("File uploaded successfully"),o(j.publicUrl,n),l(null),p(null),m.current&&(m.current.value="")}catch(t){console.error("Upload error:",t),g.error(t.message||"Failed to upload file")}finally{w(!1),d(0)}}),F=()=>{l(null),p(null),m.current&&(m.current.value="")},z=()=>s?s.type.startsWith("image/")?e.jsx(D,{className:"w-8 h-8"}):e.jsx(E,{className:"w-8 h-8"}):e.jsx(M,{className:"w-8 h-8"}),B=t=>{if(t===0)return"0 Bytes";const a=1024,n=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(a));return Math.round(t/Math.pow(a,i)*100)/100+" "+n[i]};return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:v}),e.jsxs("p",{className:"text-xs text-slate-500 mb-3",children:[h," (Max ",c,"MB)"]}),s?e.jsxs("div",{className:"border-2 border-slate-700 rounded-lg bg-slate-800 p-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[y?e.jsx("div",{className:"w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden bg-slate-900",children:e.jsx("img",{src:y,alt:"Preview",className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-24 h-24 flex-shrink-0 rounded-lg bg-slate-900 flex items-center justify-center text-slate-500",children:z()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white truncate",children:s.name}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:B(s.size)})]}),!r&&e.jsx("button",{onClick:F,className:"ml-2 p-1 text-slate-400 hover:text-white hover:bg-slate-700 rounded transition-colors",children:e.jsx(S,{className:"w-4 h-4"})})]}),r&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400 mb-1",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[f,"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${f}%`}})})]}),f===100&&!r&&e.jsxs("div",{className:"flex items-center space-x-2 mt-2 text-green-400 text-sm",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"Upload complete"})]})]})]}),!r&&f===0&&e.jsxs("div",{className:"mt-4 flex space-x-3",children:[e.jsx("button",{onClick:$,className:"flex-1 px-4 py-2 bg-primary hover:bg-opacity-80 text-white rounded-lg transition-colors font-medium",children:"Upload File"}),e.jsx("button",{onClick:F,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Cancel"})]})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-48 px-4 border-2 border-slate-700 border-dashed rounded-lg cursor-pointer bg-slate-800 hover:bg-slate-750 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6 text-slate-400",children:[e.jsx(M,{className:"w-12 h-12 mb-3"}),e.jsxs("p",{className:"mb-2 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),e.jsx("p",{className:"text-xs",children:h})]}),e.jsx("input",{ref:m,type:"file",className:"hidden",accept:N,onChange:P,disabled:r})]})]})})};export{L as F};
