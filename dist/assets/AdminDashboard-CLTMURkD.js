var N=(i,l,r)=>new Promise((o,a)=>{var x=t=>{try{s(r.next(t))}catch(c){a(c)}},j=t=>{try{s(r.throw(t))}catch(c){a(c)}},s=t=>t.done?o(t.value):Promise.resolve(t.value).then(x,j);s((r=r.apply(i,l)).next())});import{j as e,s as u}from"./index-cCeCS7Tx.js";import{r as g}from"./react-vendor-DnMe622U.js";import{g as w,b as S,U as z,A as O}from"./ui-vendor-B7h9uWP1.js";import{R as C,B as D,C as A,X as E,Y as U,T as M,e as R}from"./chart-vendor-1jjuGsJC.js";import"./supabase-vendor-BUL0ZXqy.js";const p=({icon:i,label:l,value:r,trend:o,isLoading:a})=>e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6 hover:border-slate-600 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(i,{className:"w-6 h-6 text-primary-400"})}),o&&e.jsxs("div",{className:`flex items-center space-x-1 text-sm font-medium ${o.isPositive?"text-secondary-400":"text-accent-400"}`,children:[e.jsx("span",{children:o.isPositive?"↑":"↓"}),e.jsxs("span",{children:[Math.abs(o.value),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:l}),a?e.jsx("div",{className:"h-8 w-24 bg-slate-700 animate-pulse rounded"}):e.jsx("p",{className:"text-3xl font-bold text-white",children:r})]})]}),I=()=>{const[i,l]=g.useState({totalOrganizations:0,activeOrganizations:0,totalUsers:0,pendingEscalations:0}),[r,o]=g.useState([]),[a,x]=g.useState(!0);g.useEffect(()=>{j()},[]);const j=()=>N(void 0,null,function*(){try{x(!0);const{count:s}=yield u.from("organizations").select("*",{count:"exact",head:!0}),{count:t}=yield u.from("organizations").select("*",{count:"exact",head:!0}).eq("status","active"),{count:c}=yield u.from("users").select("*",{count:"exact",head:!0});l({totalOrganizations:s||0,activeOrganizations:t||0,totalUsers:c||0,pendingEscalations:0});const b=new Date;b.setMonth(b.getMonth()-6);const{data:v}=yield u.from("organizations").select("created_at").gte("created_at",b.toISOString()),m={},f=[];for(let n=5;n>=0;n--){const h=new Date;h.setMonth(h.getMonth()-n);const d=h.toLocaleDateString("en-US",{month:"short",year:"2-digit"});f.push(d),m[d]=0}v==null||v.forEach(n=>{const d=new Date(n.created_at).toLocaleDateString("en-US",{month:"short",year:"2-digit"});m[d]!==void 0&&m[d]++});const y=f.map(n=>({month:n,count:m[n]}));o(y)}catch(s){console.error("Error loading dashboard data:",s)}finally{x(!1)}});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Dashboard"}),e.jsx("p",{className:"text-slate-400",children:"System-wide overview and analytics"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(p,{icon:w,label:"Total Organizations",value:i.totalOrganizations,isLoading:a}),e.jsx(p,{icon:S,label:"Active Organizations",value:i.activeOrganizations,isLoading:a,trend:{value:12,isPositive:!0}}),e.jsx(p,{icon:z,label:"Total Users",value:i.totalUsers,isLoading:a}),e.jsx(p,{icon:O,label:"Pending Escalations",value:i.pendingEscalations,isLoading:a})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-1",children:"Organizations Created"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Last 6 months"})]}),a?e.jsx("div",{className:"h-80 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):e.jsx(C,{width:"100%",height:320,children:e.jsxs(D,{data:r,children:[e.jsx(A,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(E,{dataKey:"month",stroke:"#94a3b8",style:{fontSize:"12px"}}),e.jsx(U,{stroke:"#94a3b8",style:{fontSize:"12px"},allowDecimals:!1}),e.jsx(M,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px",color:"#fff"},cursor:{fill:"#334155"}}),e.jsx(R,{dataKey:"count",fill:"#3b82f6",radius:[8,8,0,0]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Recent Activity"}),e.jsx("div",{className:"space-y-4",children:[{action:"New organization created",org:"City General Hospital",time:"2 hours ago"},{action:"User added to organization",org:"Riverside Clinic",time:"5 hours ago"},{action:"Settings updated",org:"Metro Health Center",time:"1 day ago"}].map((s,t)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-slate-900 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.action}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:s.org}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:s.time})]})]},t))})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"System Status"}),e.jsx("div",{className:"space-y-4",children:[{service:"API Server",status:"Operational",uptime:"99.9%"},{service:"Database",status:"Operational",uptime:"100%"},{service:"Storage",status:"Operational",uptime:"99.8%"},{service:"Edge Functions",status:"Operational",uptime:"99.7%"}].map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-secondary-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-white",children:s.service})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-secondary-400 font-medium",children:s.status}),e.jsx("p",{className:"text-xs text-slate-500",children:s.uptime})]})]},t))})]})]})]})};export{I as AdminDashboard};
